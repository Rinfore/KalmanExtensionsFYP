function dxdt = CSTRsimulfun(t,x,Q_estimate,f3_estimate)
    
    dxdt = [432.9+1.37662*10^8*x(2)*exp(-9057.01/x(1))+6.49351*10^8*x(2)*exp(-6013.95/x(1))+4.998*(300-x(1))+34.998*(-x(1)+x(3)) %%changed!
                 4.998*(4-x(2))+34.998*(-x(2)+x(4))-600000*x(2)*exp(-9057.01/x(1))-3000000*x(2)*exp(-6013.95/x(1))
                 1.37662*10^8*x(4)*exp(-9057.01/x(3))+6.49351*10^8*x(4)*exp(-6013.95/x(3))+0.001443*Q_estimate + f3_estimate*(300 - x(3))+13.332*(x(1) - x(3)) 
                 1/3*(2 - x(4))*f3_estimate + 13.332*(x(2) - x(4)) - 600000*x(4)*exp(-9057.01/x(3)) - 3000000*x(4)*exp(-6013.95/x(3))];
end